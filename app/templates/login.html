<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Inicio de Sesión</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>

<div class="login-container">
    <div class="login-card">
        <img src="{{ url_for('static', filename='img/logoPlantaCalma.png') }}" class="logo">
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                <div class="alert {{ category }}">
                    {{ message }}
                </div>
                {% endfor %}
            {% endif %}
        {% endwith %}
        <h2>Iniciar Sesión</h2>

        <form id="loginForm" method="POST">
            <div class="input-group">
                <input type="email" id="email" name="email" placeholder="Correo electrónico">
                <small id="email-error" class="live-error"></small>
            </div>
            <div class="input-group">
                <div class="password-container">
                    <input type="password" id="password" name="password" placeholder="Contraseña">
                    <button type="button" id="togglePassword" class="toggle-btn">
                        <svg id="eyeIcon" xmlns="http://www.w3.org/2000/svg" 
                            width="20" height="20" 
                            fill="none" 
                            stroke="#A487C3" 
                            stroke-width="2" 
                            stroke-linecap="round" 
                            stroke-linejoin="round" 
                            viewBox="0 0 24 24">
                            <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
                            <circle cx="12" cy="12" r="3"/>
                        </svg>
                    </button>
                </div>
                <small id="password-error" class="live-error"></small>
            </div>
            <button type="submit">Iniciar sesión</button>
        </form>
        <p id="error-message" class="frontend-error"></p>
    </div>
</div>

<script>


// Validaciones

const emailInput = document.getElementById("email");
const passwordInput = document.getElementById("password");

const emailError = document.getElementById("email-error");
const passwordError = document.getElementById("password-error");

const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;

// Validación email
emailInput.addEventListener("input", function() {
    emailInput.classList.remove("input-error", "input-success");

    if (emailInput.value.trim() === "") {
        emailError.textContent = "El correo es obligatorio.";
        emailInput.classList.add("input-error");
    } 
    else if (!emailRegex.test(emailInput.value)) {
        emailError.textContent = "Formato de correo inválido.";
        emailInput.classList.add("input-error");
    } 
    else {
        emailError.textContent = "";
        emailInput.classList.add("input-success");
    }
});

// Validación contraseña
passwordInput.addEventListener("input", function() {
    passwordInput.classList.remove("input-error", "input-success");

    if (passwordInput.value.trim() === "") {
        passwordError.textContent = "La contraseña es obligatoria.";
        passwordInput.classList.add("input-error");
    } 
    else if (passwordInput.value.length < 4) {
        passwordError.textContent = "Debe tener al menos 4 caracteres.";
        passwordInput.classList.add("input-error");
    } 
    else {
        passwordError.textContent = "";
        passwordInput.classList.add("input-success");
    }
});

// Mostrar/ocultar contraseña
const togglePassword = document.getElementById("togglePassword");
const eyeIcon = document.getElementById("eyeIcon");

togglePassword.addEventListener("click", function() {

    const isPassword = passwordInput.type === "password";

    passwordInput.type = isPassword ? "text" : "password";

    eyeIcon.innerHTML = isPassword
        ? '<path d="M17.94 17.94A10.9 10.9 0 0112 20c-7 0-11-8-11-8a21.77 21.77 0 015.17-5.94M9.9 4.24A10.94 10.94 0 0112 4c7 0 11 8 11 8a21.86 21.86 0 01-2.06 3.19M1 1l22 22"/>'
        : '<path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/>';
});

</script>

</body>
</html>